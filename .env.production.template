# Eldonia-Nex 本番環境設定テンプレート
# このファイルをコピーして .env.production を作成し、実際の値を設定してください

# ============================================================================
# 環境設定
# ============================================================================
ENVIRONMENT=production
DEBUG=False
SECRET_KEY=<本番用のシークレットキーを生成してください - 例: django-insecure-xxxxxxxxx>

# ============================================================================
# データベース設定（Aurora PostgreSQL）
# ============================================================================
DB_ENGINE=django.db.backends.postgresql
DB_NAME=eldonia_nex
DB_USER=postgres
DB_PASSWORD=<Secrets Managerから取得またはここに直接記載>
DB_HOST=<Aurora クラスターエンドポイント - 例: eldonia-nex-production.cluster-xxxxx.ap-northeast-1.rds.amazonaws.com>
DB_PORT=5432

# 読み取りレプリカ（オプション）
DB_READER_HOST=<Aurora 読み取りエンドポイント - 例: eldonia-nex-production.cluster-ro-xxxxx.ap-northeast-1.rds.amazonaws.com>

# SSL設定
DB_SSL_MODE=require
DB_SSL_ROOT_CERT=/etc/ssl/certs/rds-ca-2019-root.pem

# 接続プーリング
DB_CONN_MAX_AGE=600
DB_CONN_HEALTH_CHECKS=True

# ============================================================================
# Redis設定（Celery用）
# ============================================================================
REDIS_HOST=<ElastiCache Redisエンドポイント - 例: eldonia-nex-redis.xxxxx.0001.apne1.cache.amazonaws.com>
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=<Redisパスワード（認証有効の場合）>

# Celery設定
CELERY_BROKER_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}
CELERY_RESULT_BACKEND=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# ============================================================================
# ドメインとCORS設定
# ============================================================================
ALLOWED_HOSTS=api.eldonia-nex.com,eldonia-nex.com,www.eldonia-nex.com
CORS_ALLOWED_ORIGINS=https://eldonia-nex.com,https://www.eldonia-nex.com
CSRF_TRUSTED_ORIGINS=https://eldonia-nex.com,https://www.eldonia-nex.com

# フロントエンドURL
FRONTEND_URL=https://eldonia-nex.com
BACKEND_URL=https://api.eldonia-nex.com

# ============================================================================
# AWS設定
# ============================================================================
AWS_REGION=ap-northeast-1
AWS_ACCESS_KEY_ID=<IAMユーザーのアクセスキー>
AWS_SECRET_ACCESS_KEY=<IAMユーザーのシークレットキー>

# S3設定（メディアファイル保存用）
AWS_STORAGE_BUCKET_NAME=eldonia-nex-media
AWS_S3_CUSTOM_DOMAIN=${AWS_STORAGE_BUCKET_NAME}.s3.amazonaws.com
AWS_S3_OBJECT_PARAMETERS={'CacheControl': 'max-age=86400'}
AWS_DEFAULT_ACL=public-read
USE_S3=True

# CloudFront（オプション）
AWS_CLOUDFRONT_DOMAIN=<CloudFront distribution domain - 例: d111111abcdef8.cloudfront.net>

# ============================================================================
# メール設定（SES）
# ============================================================================
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=email-smtp.ap-northeast-1.amazonaws.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=<SES SMTPユーザー名>
EMAIL_HOST_PASSWORD=<SES SMTPパスワード>
DEFAULT_FROM_EMAIL=noreply@eldonia-nex.com
SERVER_EMAIL=admin@eldonia-nex.com

# ============================================================================
# 外部API設定
# ============================================================================

# ExchangeRate-API（為替レート取得）
EXCHANGERATE_API_KEY=<APIキーを取得してください - https://www.exchangerate-api.com/>
EXCHANGERATE_API_BASE_URL=https://v6.exchangerate-api.com/v6

# Google Maps API
GOOGLE_MAPS_API_KEY=<Google Cloud ConsoleでAPIキーを取得>

# Stripe（決済）
STRIPE_PUBLIC_KEY=pk_live_<本番用公開キー>
STRIPE_SECRET_KEY=sk_live_<本番用秘密キー>
STRIPE_WEBHOOK_SECRET=whsec_<Webhook署名シークレット>

# ============================================================================
# セキュリティ設定
# ============================================================================
SECURE_SSL_REDIRECT=True
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True
SECURE_BROWSER_XSS_FILTER=True
SECURE_CONTENT_TYPE_NOSNIFF=True
X_FRAME_OPTIONS=DENY
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# ============================================================================
# ログ設定
# ============================================================================
LOG_LEVEL=INFO
DJANGO_LOG_LEVEL=INFO
SQL_LOG_LEVEL=WARNING

# CloudWatch Logs（オプション）
AWS_CLOUDWATCH_LOG_GROUP=/aws/elasticbeanstalk/eldonia-nex/production
AWS_CLOUDWATCH_LOG_STREAM=django-app

# ============================================================================
# Sentry（エラートラッキング - オプション）
# ============================================================================
SENTRY_DSN=<Sentryプロジェクトから取得したDSN>
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# パフォーマンス設定
# ============================================================================
# Gunicorn
GUNICORN_WORKERS=4
GUNICORN_THREADS=2
GUNICORN_TIMEOUT=60

# Cache（ElastiCache Memcached - オプション）
CACHE_BACKEND=django.core.cache.backends.memcached.PyMemcacheCache
CACHE_LOCATION=<Memcachedエンドポイント - 例: eldonia-nex-cache.xxxxx.cfg.apne1.cache.amazonaws.com:11211>

# ============================================================================
# 機能フラグ
# ============================================================================
ENABLE_DEBUG_TOOLBAR=False
ENABLE_SILK_PROFILING=False
ENABLE_API_THROTTLING=True
ENABLE_RATE_LIMITING=True

# ============================================================================
# バックアップ設定
# ============================================================================
BACKUP_ENABLED=True
BACKUP_S3_BUCKET=eldonia-nex-backups
BACKUP_RETENTION_DAYS=30

# ============================================================================
# タイムゾーンと言語
# ============================================================================
TIME_ZONE=Asia/Tokyo
LANGUAGE_CODE=ja
USE_I18N=True
USE_L10N=True
USE_TZ=True

# ============================================================================
# アプリケーション固有設定
# ============================================================================

# イベント設定
MAX_EVENT_IMAGES=10
MAX_IMAGE_SIZE_MB=5

# ファイルアップロード設定
MAX_UPLOAD_SIZE=10485760  # 10MB
ALLOWED_UPLOAD_EXTENSIONS=jpg,jpeg,png,gif,pdf

# セッション設定
SESSION_COOKIE_AGE=1209600  # 2週間（秒）
SESSION_SAVE_EVERY_REQUEST=False

# ============================================================================
# モニタリングとヘルスチェック
# ============================================================================
HEALTH_CHECK_ENABLED=True
HEALTH_CHECK_PATH=/health/
METRICS_ENABLED=True
METRICS_PATH=/metrics/

# ============================================================================
# 注意事項
# ============================================================================
# 1. このファイルはGitにコミットしないでください（.gitignoreに追加済み）
# 2. AWS Secrets ManagerまたはParameter Storeの使用を推奨
# 3. 本番環境では強力なパスワードとシークレットキーを使用
# 4. 定期的にAPIキーとパスワードをローテーション
# 5. IAMロールベースのアクセス制御を優先的に使用
